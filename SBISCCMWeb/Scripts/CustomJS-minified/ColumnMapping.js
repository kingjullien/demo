$.UserRole = $("#UserRole").val(), $.UserLOBTag = $("#UserLOBTag").val(), $(document).ready(function () { var a = $("#ImportMode").val(); if ("true" == $("#IsTemplate").val().toLowerCase() || $(".SelectBox").each(function () { if ("Data Import" == a) { var e = $(this).closest("tr").find(".spnExcelColumn").attr("data-val"), t = 0; $(".SelectBox option").each(function () { var a = $(this).text(); e == a && (t = $(this).val()), "country" != a.toLowerCase() && "countrycode" != a.toLowerCase() && "countryisoalpha2code" != a.toLowerCase() && "address1_country" != a.toLowerCase() || "countryisoalpha2code" != e.toLowerCase() && "country" != e.toLowerCase() || (t = $(this).val()), "zipcode" != a.toLowerCase() && "postalcode" != a.toLowerCase() && "zip" != a.toLowerCase() && "address1_postalcode" != a.toLowerCase() || "postalcode" == e.toLowerCase() && (t = $(this).val()), "phoneno" != a.toLowerCase() && "phonenbr" != a.toLowerCase() && "phone" != a.toLowerCase() && "address1_telephone1" != a.toLowerCase() || "phonenbr" == e.toLowerCase() && (t = $(this).val()), "company" != a.toLowerCase() && "companyname" != a.toLowerCase() && "organization" != a.toLowerCase() && "address1_name" != a.toLowerCase() || "companyname" == e.toLowerCase() && (t = $(this).val()), "srcrecordid" != a.toLowerCase() && "src recordid" != a.toLowerCase() && "accountid" != a.toLowerCase() || "srcrecordid" == e.toLowerCase() && (t = $(this).val()), "language" != a.toLowerCase() && "language values" != a.toLowerCase() && "languagevalues" != a.toLowerCase() && "language code" != a.toLowerCase() && "languagecode" != a.toLowerCase() || "inlanguage" == e.toLowerCase() && (t = $(this).val()), "address" != a.toLowerCase() && "street line address1" != a.toLowerCase() && "address1_line1" != a.toLowerCase() || "street line address1" == e.toLowerCase() && (t = $(this).val()), "address1" != a.toLowerCase() && "street line address2" != a.toLowerCase() && "address1_line2" != a.toLowerCase() || "street line address2" == e.toLowerCase() && (t = $(this).val()), "altaddress" != a.toLowerCase() && "street line alt. address1" != a.toLowerCase() && "address2_line1" != a.toLowerCase() || "street line alt. address1" == e.toLowerCase() && (t = $(this).val()), "altaddress1" != a.toLowerCase() && "street line alt. address2" != a.toLowerCase() || "street line alt. address2" == e.toLowerCase() && (t = $(this).val()), "state" != a.toLowerCase() && "address1_stateorprovince" != a.toLowerCase() || "state (state is required for us)" == e.toLowerCase() && (t = $(this).val()), "address1_city" == a.toLowerCase() && "city" == e.toLowerCase() && (t = $(this).val()), "tags" != a.toLowerCase() && "tag" != a.toLowerCase() || "tags" == e.toLowerCase() && (t = $(this).val()) }), $(this).val(t); var s = $(this).attr("id"), o = $(this).val(); 0 != parseInt(o) ? $.ajax({ type: "POST", url: "/Data/UpdateExamples", data: JSON.stringify({ CurrentColumn: o }), dataType: "json", contentType: "application/json", success: function (a) { $("#" + s).parent().next().text(a) }, error: function (a, e, t) { } }) : $("#" + s).parent().next().text("") } if ("Match Refresh" == a) { e = $(this).closest("tr").find(".spnExcelColumn").attr("data-val"), t = 0; $(".SelectBox option").each(function () { var a = $(this).text(); e == a && (t = $(this).val()), "country" != a.toLowerCase() && "countrycode" != a.toLowerCase() && "countryisoalpha2code" != a.toLowerCase() && "address1_country" != a.toLowerCase() || "countryisoalpha2code" != e.toLowerCase() && "country" != e.toLowerCase() || (t = $(this).val()), "srcrecordid" != a.toLowerCase() && "src recordid" != a.toLowerCase() && "accountid" != a.toLowerCase() || "srcrecordid" == e.toLowerCase() && (t = $(this).val()), "tags" != a.toLowerCase() && "tag" != a.toLowerCase() || "tags" == e.toLowerCase() && (t = $(this).val()) }), $(this).val(t); s = $(this).attr("id"), o = $(this).val(); 0 != parseInt(o) ? $.ajax({ type: "POST", url: "/Data/UpdateExamples", data: JSON.stringify({ CurrentColumn: o }), dataType: "json", contentType: "application/json", success: function (a) { $("#" + s).parent().next().text(a) }, error: function (a, e, t) { } }) : $("#" + s).parent().next().text("") } "lob" == $.UserRole.toLowerCase() && ($(".chzn-select").attr("data-placeholder", "Add Tags (Required)"), $(".chzn-select").trigger("chosen:updated")) }), $(".chzn-select").length > 0) { var e = $("#Tags").val(); null != e && "" != e && (e = e.split(",")), null == e && "" == e || $(".chzn-select option").each(function () { for (var a = 0; a < e.length; a++)$(this).val() == e[a] && $(this).attr("selected", "selected") }), $(".chzn-select").chosen().change(function (a) { a.target == this && $("#Tags").val($(this).val()) }) } if ("Data Import" == a) { var t = 0; if ($(".SelectBox").length > 0) { if (parseInt($("#DataColumn-0").val()) > 0 && parseInt($("#DataColumn-1").val()) > 0 && parseInt($("#DataColumn-7").val()) > 0 || t++, "lob" == $.UserRole.toLowerCase()) { var s = $("#Tags").val(), o = $("#IsTag").val(); "true" == $("#LicenseEnableTags").val().toLowerCase() && ("false" == o.toLowerCase() ? "" != s && "0" != s || t++ : parseInt($("#DataColumn-10").val()) > 0 || t++) } t > 0 ? ($("#ColumnMappingFinish").attr("disabled", "disabled"), $(".TemplateButtons").attr("disabled", "disabled")) : ($("#ColumnMappingFinish").attr("disabled", !1), $(".TemplateButtons").attr("disabled", !1)) } } if ("Match Refresh" == a) { t = 0; if ($(".SelectBox").length > 0) { if (parseInt($("#DataColumn-0").val()) > 0 && parseInt($("#DataColumn-1").val()) > 0 && parseInt($("#DataColumn-2").val()) > 0 || t++, "lob" == $.UserRole.toLowerCase()) { s = $("#Tags").val(), o = $("#IsTag").val(); "true" == $("#LicenseEnableTags").val().toLowerCase() && ("false" == o.toLowerCase() ? "" != s && "0" != s || t++ : parseInt($("#DataColumn-3").val()) > 0 || t++) } t > 0 ? ($("#ColumnMappingFinish").attr("disabled", "disabled"), $(".TemplateButtons").attr("disabled", "disabled")) : ($("#ColumnMappingFinish").attr("disabled", !1), $(".TemplateButtons").attr("disabled", !1)) } } null == $(".Language").val() && $(".Language").val("") }), $(document).on("change", ".SelectBox", function () { var a = $("#ImportMode").val(), e = $(this).attr("id"), t = $(this).val(), s = $("#Tags").val(), o = $("#IsTag").val(), r = $("#LicenseEnableTags").val(); if ("Data Import" == a) { var n = 0; parseInt($("#DataColumn-0").val()) > 0 && parseInt($("#DataColumn-1").val()) > 0 && parseInt($("#DataColumn-7").val()) > 0 || n++, "lob" == $.UserRole.toLowerCase() && "true" == r.toLowerCase() && ("false" == o.toLowerCase() ? "" != s && "0" != s || n++ : parseInt($("#DataColumn-10").val()) > 0 || n++), n > 0 ? ($("#ColumnMappingFinish").attr("disabled", "disabled"), $(".TemplateButtons").attr("disabled", "disabled")) : ($("#ColumnMappingFinish").attr("disabled", !1), $(".TemplateButtons").attr("disabled", !1)) } if ("Match Refresh" == a) { n = 0; parseInt($("#DataColumn-0").val()) > 0 && parseInt($("#DataColumn-1").val()) > 0 && parseInt($("#DataColumn-2").val()) > 0 || n++, "lob" == $.UserRole.toLowerCase() && "true" == r.toLowerCase() && ("false" == o.toLowerCase() ? "" != s && "0" != s || n++ : parseInt($("#DataColumn-3").val()) > 0 || n++), n > 0 ? ($("#ColumnMappingFinish").attr("disabled", "disabled"), $(".TemplateButtons").attr("disabled", "disabled")) : ($("#ColumnMappingFinish").attr("disabled", !1), $(".TemplateButtons").attr("disabled", !1)) } 0 != parseInt(t) ? $.ajax({ type: "POST", url: "/ImportData/UpdateExamples", data: JSON.stringify({ CurrentColumn: t }), dataType: "json", contentType: "application/json", success: function (a) { $("#" + e).parent().next().text(a) }, error: function (a, e, t) { } }) : $("#" + e).parent().next().text("") }), $(document).on("click", "#ColumnMappingFinish", function () { var a = [], e = [], t = [], s = 0, o = $("#Tags").val(), r = ($("#IsTag").val(), $("#IsInLanguage").val(), $(".Language").val()), n = ($("#LicenseEnableTags").val(), $("#fileType").val()); $("#ImportMode").val(); if (null != o && "0" != o || (o = ""), null == r && (r = ""), $(".SelectBox").each(function () { a.push($(this).val()), 1, $(this).hasClass("chzn-select") ? e.push("Tags") : $(this).hasClass("Language") ? e.push("InLanguage") : e.push($(this).find(":selected").text()), $(this).parent().removeClass("has-error") }), a.length > 0) for (var l = 0; l < a.length; l++) { 0 != l && 1 != l && 7 != l || 0 == $("#DataColumn-" + l).val() && $("#DataColumn-" + l).parent().addClass("has-error"); for (var i = 0; i <= a.length; i++)if (l != i && a[l] == a[i]) { 1; var u = $("#DataColumn-" + l).val(), c = $("#DataColumn-" + i).val(); (parseInt(u) > 0 || parseInt(c) > 0) && (s += 1, parseInt(u) > 0 && $("#DataColumn-" + l).parent().addClass("has-error"), parseInt(c) > 0 && $("#DataColumn-" + i).parent().addClass("has-error")) } } if ($(".spnExcelColumn").each(function () { var a = $(this).attr("data-val"); "State (State is required for US)" == a && (a = "State"), t.push(a) }), 0 == $("#DataColumn-0").val() || 0 == $("#DataColumn-1").val() || 0 == $("#DataColumn-7").val()) return !1; if (s > 0) return !1; if (!$(".norecored").is(":visible")) { var d = $('input[name="__RequestVerificationToken"]').val(); return $.ajax({ type: "POST", url: "/ImportData/ConfirmImportDetails", data: JSON.stringify({ OrgColumnName: e, ExcelColumnName: t, Tags: o, InLanguage: r, fileType: n }), contentType: "application/json", headers: { __RequestVerificationToken: d }, success: function (a) { $("#ImportProcessStep").html(a) }, error: function (a, e, t) { } }), !0 } return parent.ShowMessageNotification("success", "Please Upload Data first.", !0, !1), !1 }), $(document).on("click", ".TemplateButtons", function () { var a, e = $(this).val(), t = [], s = [], o = [], r = 0, n = $("#Tags").val(), l = ($("#IsTag").val(), $("#IsInLanguage").val(), $(".Language").val()), i = ($("#LicenseEnableTags").val(), $("#fileType").val()); if (a = "/ImportData/SaveTemplate", null != n && "0" != n || (n = ""), null == l && (l = ""), $(".SelectBox").each(function () { t.push($(this).val()), 1, $(this).hasClass("chzn-select") ? s.push("Tags") : $(this).hasClass("Language") ? s.push("InLanguage") : s.push($(this).find(":selected").text()), $(this).parent().removeClass("has-error") }), t.length > 0) for (var u = 0; u < t.length; u++) { 0 != u && 1 != u && 7 != u || 0 == $("#DataColumn-" + u).val() && $("#DataColumn-" + u).parent().addClass("has-error"); for (var c = 0; c <= t.length; c++)if (u != c && t[u] == t[c]) { 1; var d = $("#DataColumn-" + u).val(), p = $("#DataColumn-" + c).val(); (parseInt(d) > 0 || parseInt(p) > 0) && (r += 1, parseInt(d) > 0 && $("#DataColumn-" + u).parent().addClass("has-error"), parseInt(p) > 0 && $("#DataColumn-" + c).parent().addClass("has-error")) } } if ($(".spnExcelColumn").each(function () { var a = $(this).attr("data-val"); "State (State is required for US)" == a && (a = "State"), o.push(a) }), 0 == $("#DataColumn-0").val() || 0 == $("#DataColumn-1").val() || 0 == $("#DataColumn-7").val()) return !1; if (r > 0) return !1; if ($(".norecored").is(":visible")) ShowMessageNotification("success", "Please Upload Data first.", !0, !1); else { if ("save as template" != e.toLowerCase()) { var C = $('input[name="__RequestVerificationToken"]').val(); return $.ajax({ type: "POST", url: a, data: JSON.stringify({ OrgColumnName: s, ExcelColumnName: o, Tags: n, InLanguage: l, fileType: i }), contentType: "application/json", headers: { __RequestVerificationToken: C }, success: function (a) { ShowMessageNotification("success", "Template saved successfully.", !0, !1) }, error: function (a, e, t) { } }), !0 } bootbox.prompt({ title: "Enter Template Name", centerVertical: !0, callback: function (e) { if ("" != e && null != e) { var t = $('input[name="__RequestVerificationToken"]').val(); return $.ajax({ type: "POST", url: a, data: JSON.stringify({ OrgColumnName: s, ExcelColumnName: o, Tags: n, InLanguage: l, fileType: i, TemplateName: e }), contentType: "application/json", headers: { __RequestVerificationToken: t }, success: function (a) { ShowMessageNotification("success", a, !0, !1) }, error: function (a, e, t) { } }), !0 } return ShowMessageNotification("success", "Please Enter Template Name", !0, !1), !1 } }) } return !1 }), $(document).on("click", "#ColumnMappingPrev", function () { var a = $("#fileType").val(), e = $("#ImportMode").val(); $.ajax({ type: "GET", url: "/ImportData/UploadFileIndex?FileFormat=" + a + "&ImportMode=" + e, dataType: "html", async: !1, contentType: !1, processData: !1, success: function (a) { $("#ImportProcessStep").html(a) } }) });