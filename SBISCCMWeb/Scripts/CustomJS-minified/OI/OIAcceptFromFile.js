function LoadAcceptMapping(a) { $.ajax({ type: "POST", url: "/OIMatchData/BindAcceptFileMapping", data: a, dataType: "html", async: !1, contentType: !1, processData: !1, success: function (a) { $("#DivPartialBindAcceptMapping").html(a), $(".SelectBox").each(function () { var a = $(this).parent().parent().find(".spnExcelColumn").attr("data-val"), t = 0; $(".SelectBox option").each(function () { var e = $(this).text(); a == e && (t = $(this).val()), "srcrecordid" != e.toLowerCase() && "src recordid" != e.toLowerCase() && "accountid" != e.toLowerCase() || "srcrecordid" == a.toLowerCase() && (t = $(this).val()), "inputid" == e.toLowerCase() && "inputid" == a.toLowerCase() && (t = $(this).val()), "dnbdunsnumber" != e.toLowerCase() && "dunsnumber" != e.toLowerCase() || "dnbdunsnumber" == a.toLowerCase() && (t = $(this).val()) }), $(this).val(t); var e = 0; parseInt($("#DataColumn-0").val()) > 0 && parseInt($("#DataColumn-1").val()) > 0 && parseInt($("#DataColumn-2").val()) > 0 || e++ , e > 0 ? $("#btnInsertAcceptData").attr("disabled", "disabled") : $("#btnInsertAcceptData").attr("disabled", !1) }) } }) } function LoadOIMatchAcceptFromFile() { var a = 0; parseInt($("#DataColumn-0").val()) > 0 && parseInt($("#DataColumn-1").val()) > 0 && parseInt($("#DataColumn-2").val()) > 0 || a++ , a > 0 ? $("#btnInsertAcceptData").attr("disabled", "disabled") : $("#btnInsertAcceptData").attr("disabled", !1) } $("body").on("change", "#MatchAcceptFile", function () { if ("" != $("#file").val()) { var a = $("#allowedFormats").val().split(","); if (-1 == $.inArray($(this).val().split(".").pop().toLowerCase(), a)) ShowMessageNotification("success", matchAcceptAllowedFormats + a.join(", "), !0), $("#MatchAcceptFile").val(""); else { var t = new FormData; null != $("#MatchAcceptFile")[0].files[0] && (t.append("file", $(this)[0].files[0]), LoadAcceptMapping(t)) } } }), $("body").on("click", "#btnInsertAcceptData", function () { var a = [], t = [], e = [], n = 0; if ($(".SelectBox").each(function () { a.push($(this).val()), 1, "0" == $(this).val() && 1, t.push($(this).find(":selected").text()), $(this).parent().removeClass("has-error") }), a.length > 0) for (var s = 0; s < a.length; s++)for (var c = 0; c <= a.length; c++)if (s != c && a[s] == a[c]) { if (1, "0" != a[s]) { var l = $("#DataColumn-" + s).val(); parseInt(l) > 0 && $("#DataColumn-" + s).parent().addClass("has-error"); l = $("#DataColumn-" + c).val(); parseInt(l) > 0 && $("#DataColumn-" + c).parent().addClass("has-error") } n += 1 } return $(".spnExcelColumn").each(function () { var a = $(this).attr("data-val"); e.push(a) }), 0 == $("#DataColumn-0").val() || 0 == $("#DataColumn-1").val() || 0 == $("#DataColumn-2").val() ? ($("#btnInsertAcceptData").attr("disabled", "disabled"), !1) : n > 0 ? ($("#btnInsertAcceptData").attr("disabled", "disabled"), !1) : ($("#btnInsertAcceptData").attr("disabled", !1), $.ajax({ type: "POST", url: "/OIMatchData/AcceptDataFile", data: JSON.stringify({ OrgColumnName: t, ExcelColumnName: e }), dataType: "json", contentType: "application/json", cache: !1, success: function (a) { ShowMessageNotification("success", a, !1), $("#OIMatchDataAcceptFromFileModal").modal("hide"), callbackRejectPurgeData() }, error: function (a, t, e) { } }), !0) }), $("body").on("change", ".SelectBox", function () { var a = 0; parseInt($("#DataColumn-0").val()) > 0 && parseInt($("#DataColumn-1").val()) > 0 && parseInt($("#DataColumn-2").val()) > 0 || a++ , a > 0 ? $("#btnInsertAcceptData").attr("disabled", "disabled") : $("#btnInsertAcceptData").attr("disabled", !1) });