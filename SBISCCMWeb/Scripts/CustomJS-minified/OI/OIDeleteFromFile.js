function LoadRejectMapping(a) { $.ajax({ type: "POST", url: "/OIMatchData/BindDeleteMapping", data: a, dataType: "html", async: !1, contentType: !1, processData: !1, success: function (a) { $("#DivPartialBindDeleteMapping").html(a), $(".SelectBox").each(function () { var a = $(this).parent().parent().find(".spnExcelColumn").attr("data-val"), e = 0; $(".SelectBox option").each(function () { var t = $(this).text(); a == t && (e = $(this).val()), "srcrecordid" != t.toLowerCase() && "src recordid" != t.toLowerCase() && "accountid" != t.toLowerCase() || "srcrecordid" == a.toLowerCase() && (e = $(this).val()), "inputid" == t.toLowerCase() && "inputid" == a.toLowerCase() && (e = $(this).val()) }), $(this).val(e) }) } }) } $("body").on("change", "#DeletePurgeFile", function () { if ("" != $("#file").val()) { var a = $("#allowedFormats").val().split(","); if (-1 == $.inArray($(this).val().split(".").pop().toLowerCase(), a)) { var e = new FormData; null != $("#DeletePurgeFile")[0].files[0] && (e.append("file", $(this)[0].files[0]), LoadRejectMapping(e)) } else parent.ShowMessageNotification("success", uploadCertainFile + a.join(", "), !0), $("#DeletePurgeFile").val("") } }), $("body").on("click", "#btnInsertDeleteData", function () { var a = [], e = [], t = [], n = 0, o = 0; if ($(".SelectBox").each(function () { a.push($(this).val()), 1, "0" == $(this).val() || null == $(this).val() ? (n += 1, $(this).parent().addClass("has-error")) : $(this).parent().removeClass("has-error"), e.push($(this).find(":selected").text()) }), n > 0) return !1; if (a.length > 0) for (var i = 0; i < a.length; i++)for (var l = 0; l <= a.length; l++)if (i != l && a[i] == a[l]) { if (1, "0" != a[i]) { var r = $("#DataColumn-" + i).val(); parseInt(r) > 0 && $("#DataColumn-" + i).parent().addClass("has-error"); r = $("#DataColumn-" + l).val(); parseInt(r) > 0 && $("#DataColumn-" + l).parent().addClass("has-error") } o += 1 } return $(".spnExcelColumn").each(function () { var a = $(this).attr("data-val"); t.push(a) }), 0 != $("#DataColumn-0").val() && 0 != $("#DataColumn-1").val() && (!(o > 0) && (bootbox.confirm({ title: "<i class='fa fa-check-square-o' aria-hidden='true'></i> " + confirmBox, message: deleteCompanyData, callback: function (a) { a && $.ajax({ type: "POST", url: "/OIMatchData/DeleteData", data: JSON.stringify({ OrgColumnName: e, ExcelColumnName: t }), dataType: "json", contentType: "application/json", cache: !1, success: function (a) { ShowMessageNotification("success", a, !1), $("#OIMatchDeleteFromFileModal").modal("hide"), callbackRejectPurgeData() }, error: function (a, e, t) { } }) } }), !0)) });