function ValidationProcess() { var e = $("#rdExcel").prop("checked"), t = $("#rdCSV").prop("checked"), o = $("#rdTSV").prop("checked"), a = $("#rdText").prop("checked"), r = $("#txtSrcRecID").val().trim(), s = ConvertEncrypte(encodeURI(r)).split("+").join("***"); countProcess = 0, 0 == $("#MultiSelectOptions option:selected").length && countProcess++ , 1 == countProcess ? $("#spnProcess").css("display", "block") : $("#spnProcess").css("display", "none"); var n = 0; if (0 == e && n++ , 0 == t && n++ , 0 == o && n++ , 0 == a && n++ , 4 == n ? $("#spnFormat").css("display", "block") : $("#spnFormat").css("display", "none"), 1 == countProcess || 4 == n) return !1; if (a) { var i = $("#Delimiter").val().trim(); if ("" == i) return OpenDelimiter(), !1 } var l = $("#SrcRecIdExactMatch").prop("checked"), c = $("#LOBTag").val(), p = $("#Tags").val(), d = $("#Input").val(), u = $("#MultiSelectOptions option:selected").map(function () { return this.text }).get().join(", "); u = u.replace("Enrichment", "Firmographics"); var g = $("input[name=Format]:checked").val(), m = $("#MarkAsExported").prop("checked"), v = noFilterSelected, y = "<table class='ExportConfirmBox'>"; "" != r && (y += "<tr><td><strong><span>" + srcRecordId + "</span></strong></td><td>&nbsp:&nbsp</td><td> <span style='word-wrap: anywhere;'>" + r + "</span> <strong><span>" + isExactMatch + "</span></strong> : " + l + "</td><tr>"), null != c && "" != c && (y += "<tr><td><strong><span>" + lobTag + "</span></strong></td><td>&nbsp:&nbsp</td><td> " + c + "</td><tr>"), null != c && "" != p && (y += "<tr><td><strong><span>" + tag + "</span></strong></td><td>&nbsp:&nbsp</td><td> " + p + "</td><tr>"), "" != d && (y += "<tr><td><strong><span>" + importPorcess + "</span></strong></td><td>&nbsp:&nbsp</td><td> " + d + "</td><tr>"), y += "<tr><td><strong><span>" + selectedOutput + "</span></strong></td><td>&nbsp:&nbsp</td><td> " + u + "</td><tr>", y += "<tr><td><strong><span>" + g + "</span></strong></td><td>&nbsp:&nbsp</td><td> " + g + "</td><tr>", a && (y += "<tr><td><strong><span>" + delimiterValue + "</span></strong></td><td>&nbsp:&nbsp</td><td> " + i + "</td><tr>"), y += "<tr><td><strong><span>" + markAsExported + "</span></strong></td><td>&nbsp:&nbsp</td><td>" + m + "</td><tr>", "" != r || "" != c && null != c || "" != p && null != p || "" != d || (y += "<tr><td></tr></td><tr><td colspan='5'><span class='error'>" + v + "</span></td></tr>"), y += "</table>", bootbox.confirm({ title: "<i class='fa fa-check-square-o' aria-hidden='true'></i> " + confirmBox, message: y, callback: function (e) { e && $.ajax({ type: "GET", url: "/OIExportView/ExportFileName?Parameters=" + s, dataType: "HTML", async: !1, success: function (e) { $("#ExportFileNameModalMain").html(e), DraggableModalPopup("#ExportFileNameModal") } }) } }) } function ExportSubmitProcess(e) { $("#ExportFileNameModal").modal("hide"), $("#MultiSelectOptions option").each(function () { var e = "#" + $(this).val(); $(e).val(this.selected) }), $("#FilePath").val(e), $("#OIExportDatafrm").submit() } function OpenDelimiter() { var e = $("#Delimiter").val(); $.ajax({ type: "GET", url: "/OIExportView/Delimiter?Parameters=" + ConvertEncrypte(encodeURI(e)).split("+").join("***"), dataType: "HTML", async: !1, success: function (e) { $("#CustomExportDelimiterModalMain").html(e), DraggableModalPopup("#CustomExportDelimiterModal") } }) } function callbackCloseDelimiter(e) { $("#CustomExportDelimiterModal").modal("hide"), $("#Delimiter").val(e) } function RefreshExportList(e) { $.ajax({ type: "GET", url: e, dataType: "HTML", contentType: "application/html", async: !1, cache: !1, success: function (e) { $("#divExportJobListing").html(e), pageSetUp() }, error: function (e, t, o) { } }) } function OnSuccess() { $("#divProgress").hide(), pageSetUp(); var e = $("#UserType").val(); "lob" != $.UserRole.toLowerCase() && "steward" != e.toLowerCase() || (jQuery("#DisplayFileType option:contains('All Files')").remove(), jQuery("#MonitoringDisplayFileType option:contains('All Files')").remove()) } function CancelExportREquest(e, t) { var o = "/OIExportView/CancelExportProcess?Id=" + e; bootbox.confirm({ title: "<i class='fa fa-check-square-o' aria-hidden='true'></i> " + confirmBox, message: ConfirmExportRequest, callback: function (e) { e && $.ajax({ type: "POST", url: o, dataType: "json", contentType: "application/json", async: !1, cache: !1, success: function (e) { ShowMessageNotification("success", e.message, !1), e.result && RefreshExportList(t) }, error: function (e, t, o) { } }) } }) } function UpdateOIExportCompany(e) { if (e.result) { var t = $(".pagevalueChange").val(), o = $("#pageno").val(); RefreshExportList("/OI/ExportView?pagevalue=" + t + "&sortby=" + $("#SortBy").val() + "&sortorder=" + $("#SortOrder").val() + "&FileType=" + $("#FileType").val() + "&page=" + o) } ShowMessageNotification("success", e.message, !1) } $(document).ajaxStart(function () { $("#divProgress").show() }).ajaxStop(function () { $("#divProgress").hide() }), $.UserRole = $("#UserRole").val(), $.UserLOBTag = $("#UserLOBTag").val(), $(document).ready(function () { $("#MultiSelectOptions option").each(function () { "MatchOutput" != $(this).val() && "Enrichment" != $(this).val() || $(this).attr("selected", !0) }), $("#MultiSelectOptions").multiselect({ includeSelectAllOption: !0, numberDisplayed: 6, allSelectedText: "", nonSelectedText: selectOutputQueue }), "lob" == $.UserRole.toLowerCase() && ($("#LOBTag").val($.UserLOBTag), $("#LOBTag").attr("disabled", !0)), $("select.chzn-select").chosen({ no_results_text: nothingFound, width: "100%", search_contains: !0 }) }), $("body").on("click", "#btnOIExportData", function () { ValidationProcess() }), $("body").on("click", ".OpenDelimiter", function () { OpenDelimiter() }), $("body").on("click", "input:radio[name=Format]", function () { "delimiter" != $(this).val().trim().toLowerCase() && $("#Delimiter").val("") }), $("body").on("click", ".deleteFile", function () { var e = $(".pagevalueChange").val(), t = $("#pageno").val(), o = "/OI/ExportView?pagevalue=" + e + "&sortby=" + $("#SortBy").val() + "&sortorder=" + $("#SortOrder").val() + "&FileType=" + $("#FileType").val() + "&page=" + t, a = "/OIExportView/Delete?Id=" + $(this).attr("id"); bootbox.confirm({ title: "<i class='fa fa-check-square-o' aria-hidden='true'></i> " + confirmBox, message: DeleteExportRecord, callback: function (e) { e && $.ajax({ type: "POST", url: a, dataType: "json", contentType: "application/json", async: !1, cache: !1, success: function (e) { ShowMessageNotification("success", e.message, !1), e.result && RefreshExportList(o) }, error: function (e, t, o) { } }) } }) }), $("body").on("change", ".DisplayFileType", function () { RefreshExportList("/OI/ExportView?FileType=" + $(this)[0].value) }), $("body").on("change", ".pagevalueChange", function () { var e = $("#UserType").val(), t = "/OI/ExportView?pagevalue=" + $(this)[0].value + "&sortby=" + $("#SortBy").val() + "&sortorder=" + $("#SortOrder").val() + "&FileType=" + $("#FileType").val(); $.ajax({ type: "GET", url: t, dataType: "HTML", contentType: "application/html", async: !1, cache: !1, success: function (t) { $("#divExportJobListing").html(t), pageSetUp(), "lob" != $.UserRole.toLowerCase() && "steward" != e.toLowerCase() || jQuery("#DisplayFileType option:contains('All Files')").remove() }, error: function (e, t, o) { } }) }), $("body").on("click", ".CancelFile", function () { var e = $(".pagevalueChange").val(), t = $("#pageno").val(), o = "/OI/ExportView?pagevalue=" + e + "&sortby=" + $("#SortBy").val() + "&sortorder=" + $("#SortOrder").val() + "&FileType=" + $("#FileType").val() + "&page=" + t; CancelExportREquest($(this).attr("id"), o) });