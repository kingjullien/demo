$(document).on("click", "#btnInvestigationFileSubmit", function () { var a = $("#InvestigationColumnMappingModal #Type").val(), n = [], t = [], i = [], e = 0, o = 0; if ($("#InvestigationColumnMappingModal .SelectBox").each(function () { n.push($(this).val()), 1, t.push($(this).find(":selected").text()), $(this).parent().removeClass("has-error") }), "mini" == a.toLowerCase()) { if (n.length > 0) for (var l = 0; l < n.length; l++) { 4 != l && 0 == $("#InvestigationColumnMappingModal #DataColumn-" + l).val() && ($("#InvestigationColumnMappingModal #DataColumn-" + l).parent().addClass("has-error"), o++); for (var s = 0; s <= n.length; s++)if (l != s && n[l] == n[s]) { 1; var r = $("#InvestigationColumnMappingModal #DataColumn-" + l).val(), p = $("#InvestigationColumnMappingModal #DataColumn-" + s).val(); (parseInt(r) > 0 || parseInt(p) > 0) && (e += 1, parseInt(r) > 0 && $("#InvestigationColumnMappingModal #DataColumn-" + l).parent().addClass("has-error"), parseInt(p) > 0 && $("#InvestigationColumnMappingModal #DataColumn-" + s).parent().addClass("has-error")) } } var u = $("#InvestigationColumnMappingModal #rComments").val(), m = $("#InvestigationColumnMappingModal #reqEmail").val(); if ("" == u || null == u || null == u ? (o++ , $("#InvestigationColumnMappingModal .errResearchComments").show()) : $("#InvestigationColumnMappingModal .errResearchComments").hide(), "" == m || null == m || null == m ? (o++ , $("#InvestigationColumnMappingModal .errCustEmail").text("Requestor Email is required."), $("#InvestigationColumnMappingModal .errCustEmail").show()) : isValidEmailAddress(m) ? $("#InvestigationColumnMappingModal .errCustEmail").hide() : (o++ , $("#InvestigationColumnMappingModal .errCustEmail").text("Please enter valid email address."), $("#InvestigationColumnMappingModal .errCustEmail").show()), $("#InvestigationColumnMappingModal .spnExcelColumn").each(function () { var a = $(this).attr("data-val"); i.push(a) }), o > 0) return !1; if (e > 0) return !1; $.ajax({ type: "POST", url: "/ResearchInvestigation/SubmitColumnMapping", data: JSON.stringify({ OrgColumnName: t, ExcelColumnName: i, Email: m, Comment: u }), contentType: "application/json", success: function (a) { $("#InvestigationColumnMappingModal").modal("hide"), ShowMessageNotification("success", a, !1) }, error: function (a, n, t) { } }) } else { var g = [0, 1, 3, 4, 6, 7]; if (n.length > 0) for (var d = 0; d < n.length; d++) { g.indexOf(d) > -1 && 0 == $("#InvestigationColumnMappingModal #DataColumn-" + d).val() && ($("#InvestigationColumnMappingModal #DataColumn-" + d).parent().addClass("has-error"), o++); for (var C = 0; C <= n.length; C++)if (d != C && n[d] == n[C]) { 1; var M = $("#InvestigationColumnMappingModal #DataColumn-" + d).val(), v = $("#InvestigationColumnMappingModal #DataColumn-" + C).val(); (parseInt(M) > 0 || parseInt(v) > 0) && (e += 1, parseInt(M) > 0 && $("#InvestigationColumnMappingModal #DataColumn-" + d).parent().addClass("has-error"), parseInt(v) > 0 && $("#InvestigationColumnMappingModal #DataColumn-" + C).parent().addClass("has-error")) } } var c = $("#InvestigationColumnMappingModal #reqEmail").val(); if ("" == c || null == c || null == c ? (o++ , $("#InvestigationColumnMappingModal .errCustEmail").text("Requestor Email is required."), $("#InvestigationColumnMappingModal .errCustEmail").show()) : isValidEmailAddress(c) ? $("#InvestigationColumnMappingModal .errCustEmail").hide() : (o++ , $("#InvestigationColumnMappingModal .errCustEmail").text("Please enter valid email address."), $("#InvestigationColumnMappingModal .errCustEmail").show()), $("#InvestigationColumnMappingModal .spnExcelColumn").each(function () { var a = $(this).attr("data-val"); i.push(a) }), o > 0) return !1; if (e > 0) return !1; $.ajax({ type: "POST", url: "/ResearchInvestigation/SubmitColumnMappingTargeted", data: JSON.stringify({ OrgColumnName: t, ExcelColumnName: i, Email: c }), contentType: "application/json", success: function (a) { $("#InvestigationColumnMappingModal").modal("hide"), ShowMessageNotification("success", a, !1) }, error: function (a, n, t) { } }) } }), $(document).on("change", "#InvestigationColumnMappingModal .SelectBox", function () { var a = $(this).attr("id"), n = $(this).val(); 0 != parseInt(n) ? $.ajax({ type: "POST", url: "/ResearchInvestigation/UpdateExamples", data: JSON.stringify({ CurrentColumn: n }), dataType: "json", contentType: "application/json", success: function (n) { $("#" + a).parent().parent().next().text(n) }, error: function (a, n, t) { } }) : $("#" + a).parent().parent().next().text("") });