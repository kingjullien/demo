$(document).ajaxStart(function () { $("#divProgress").show() }).ajaxStop(function () { $("#divProgress").hide() }), $("body").on("click", "#btnSubmitImportData", function () { var a = new FormData; if (null == $("#file")[0].files[0]) return parent.ShowMessageNotification("success", selectFile, !1), !1; a.append("file", $("#file")[0].files[0]), a.append("header", $("#WithHeader").prop("checked")); var e = $('input[name="__RequestVerificationToken"]').val(); try { $.ajax({ type: "POST", url: "/Portal/CountryImportData", data: a, headers: { __RequestVerificationToken: e }, dataType: "json", contentType: !1, processData: !1, async: !1, success: function (a) { return "Only formats allowed are :xls,xlsx" == a ? (parent.ShowMessageNotification("success", a, !1), $("#file").val(""), !1) : a.indexOf("already belongs to this file") > -1 ? (parent.ShowMessageNotification("success", a, !1), !1) : a.indexOf("Error:") > -1 ? (parent.ShowMessageNotification("success", a, !1), !1) : void ("success" == a && parent.CloseImportPanel()) }, error: function (a, e, t) { } }) } catch (a) { } return !1 }), $("body").on("change", ".SelectBox", function () { var a = $(this).attr("id"), e = $(this).val(); parseInt($("#DataColumn-0").val()) > 0 && parseInt($("#DataColumn-1").val()) ? $("#btnInsertData").attr("disabled", !1) : $("#btnInsertData").attr("disabled", "disabled"), 0 != parseInt(e) ? $.ajax({ type: "POST", url: "/Portal/UpdateExamples", data: JSON.stringify({ CurrentColumn: e }), dataType: "json", contentType: "application/json", success: function (e) { $("#" + a).parent().next().text(e) }, error: function (a, e, t) { } }) : $("#" + a).parent().next().text("") }), $("body").on("click", "#btnInsertData", function () { var a = [], e = [], t = [], n = 0; if ($(".SelectBox").each(function () { a.push($(this).val()), 1, "0" == $(this).val() && 1, e.push($(this).find(":selected").text()), $(this).parent().removeClass("has-error") }), a.length > 0) for (var o = 0; o < a.length; o++)for (var r = o; r <= a.length; r++)if (o != r && a[o] == a[r]) { if (1, "0" != a[o]) { var s = $("#DataColumn-" + o).val(); parseInt(s) > 0 && $("#DataColumn-" + o).parent().addClass("has-error"); s = $("#DataColumn-" + r).val(); parseInt(s) > 0 && $("#DataColumn-" + r).parent().addClass("has-error") } n += 1 } if ($(".spnExcelColumn").each(function () { var a = $(this).attr("data-val"); t.push(a) }), 0 == $("#DataColumn-0").val() || 0 == $("#DataColumn-1").val()) return !1; if (n > 0) return !1; if ($(".norecored").is(":visible")) parent.ShowMessageNotification("success", uploadData, !0); else { var i = $('input[name="__RequestVerificationToken"]').val(); bootbox.confirm({ title: "<i class='fa fa-check-square-o' aria-hidden='true'></i> " + confirmBox, message: overwrite, callback: function (a) { try { $.ajax({ type: "POST", url: "/Portal/CountryDataMatch", data: JSON.stringify({ OrgColumnName: e, ExcelColumnName: t, IsOverWrite: a }), headers: { __RequestVerificationToken: i }, dataType: "json", contentType: "application/json", cache: !1, success: function (a) { $("#CountryGroupImportModal").modal("hide"), bootbox.hideAll(), parent.ShowMessageNotification("success", a, !0) }, error: function (a, e, t) { } }) } catch (a) { } return !0 } }) } return !1 }), $("#file").change(function () { if ("" != $("#file").val()) { var a = ["xls", "xlsx"]; -1 == $.inArray($(this).val().split(".").pop().toLowerCase(), a) && (parent.ShowMessageNotification("success", allowedFormats + a.join(", "), !1), $("#file").val("")) } });