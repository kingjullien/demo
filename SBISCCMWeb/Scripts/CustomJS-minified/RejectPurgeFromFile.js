function LoadRejectMapping(e) { $.ajax({ type: "POST", url: "/StewardshipPortal/BindRejectMapping", data: e, dataType: "html", async: !1, contentType: !1, processData: !1, success: function (e) { $("#DivPartialBindRejectMapping").html(e), $("#divPurgeFromFile .SelectBox").each(function () { var e = $(this).parent().parent().find(".spnExcelColumn").attr("data-val"), a = 0; $(".SelectBox option").each(function () { var t = $(this).text(); e == t && (a = $(this).val()), "srcrecordid" != t.toLowerCase() && "src recordid" != t.toLowerCase() && "accountid" != t.toLowerCase() || "srcrecordid" == e.toLowerCase() && (a = $(this).val()), "inputid" == t.toLowerCase() && "inputid" == e.toLowerCase() && (a = $(this).val()) }), $(this).val(a) }) } }) } $(document).on("change", "#divPurgeFromFile #RejectPurgeFile", function () { if ("" != $("#file").val()) { var e = $("#divPurgeFromFile #allowedFormats").val().split(","); if (-1 == $.inArray($(this).val().split(".").pop().toLowerCase(), e)) parent.ShowMessageNotification("success", formatsAllowed + e.join(", "), !0), $("#divPurgeFromFile #RejectPurgeFile").val(""); else { var a = new FormData; null != $("#divPurgeFromFile #RejectPurgeFile")[0].files[0] && (a.append("file", $(this)[0].files[0]), LoadRejectMapping(a)) } } }), $(document).on("click", "#btnInsertRejectData", function () { var e = [], a = [], t = [], r = 0, i = 0, o = $("#divPurgeFromFile #IsPurgeData").val(); if ("false" == o.toLocaleLowerCase() && (o = $("#divPurgeFromFile #chkRejectAll").prop("checked")), $("#divPurgeFromFile .SelectBox").each(function () { e.push($(this).val()), 1, "0" == $(this).val() || null == $(this).val() ? (r += 1, $(this).parent().addClass("has-error")) : $(this).parent().removeClass("has-error"), a.push($(this).find(":selected").text()) }), r > 0) return !1; if (e.length > 0) for (var l = 0; l < e.length; l++)for (var n = 0; n <= e.length; n++)if (l != n && e[l] == e[n]) { if (1, "0" != e[l]) { var s = $("#divPurgeFromFile #DataColumn-" + l).val(); parseInt(s) > 0 && $("#divPurgeFromFile #DataColumn-" + l).parent().addClass("has-error"); s = $("#divPurgeFromFile #DataColumn-" + n).val(); parseInt(s) > 0 && $("#divPurgeFromFile #DataColumn-" + n).parent().addClass("has-error") } i += 1 } return $("#divPurgeFromFile .spnExcelColumn").each(function () { var e = $(this).attr("data-val"); t.push(e) }), 0 != $("#divPurgeFromFile #DataColumn-0").val() && 0 != $("#divPurgeFromFile #DataColumn-1").val() && (!(i > 0) && ($.ajax({ type: "POST", url: "/StewardshipPortal/RejectData", data: JSON.stringify({ OrgColumnName: a, ExcelColumnName: t, IsPurgeData: o }), dataType: "json", contentType: "application/json", cache: !1, success: function (e) { $("#divPurgeDataModal").modal("hide"), parent.ShowMessageNotification("error", e, !1, !0, parent.callbackRejectPurgeData) }, error: function (e, a, t) { } }), !0)) });